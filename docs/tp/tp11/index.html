<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Séance 11 #  Exercice 1 #  Je n&rsquo;arrive pas à ajouter des images pour le moment. #PasDeChance
Exercice 2 #  S&rsquo;il n&rsquo;y a qu&rsquo;un seul contrôleur, il n&rsquo;y aura qu&rsquo;un seul ascenseur en mouvement à la fois.
Exercice 3 #  Impact #  Impacte la vitesse de traitement des requêtes par les acenseurs car ils &ldquo;bloquent&rdquo;. Rien d&rsquo;autre.
Diagramme #  Pas besoin de contrôleur
Exercice 4 #  % Enlevez le controleur proc {Lift Num Init Cid Floors ?"><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Séance 11"><meta property="og:description" content="Séance 11 #  Exercice 1 #  Je n&rsquo;arrive pas à ajouter des images pour le moment. #PasDeChance
Exercice 2 #  S&rsquo;il n&rsquo;y a qu&rsquo;un seul contrôleur, il n&rsquo;y aura qu&rsquo;un seul ascenseur en mouvement à la fois.
Exercice 3 #  Impact #  Impacte la vitesse de traitement des requêtes par les acenseurs car ils &ldquo;bloquent&rdquo;. Rien d&rsquo;autre.
Diagramme #  Pas besoin de contrôleur
Exercice 4 #  % Enlevez le controleur proc {Lift Num Init Cid Floors ?"><meta property="og:type" content="article"><meta property="og:url" content="https://ahzed11.github.io/guide-oz/docs/tp/tp11/"><meta property="article:section" content="docs"><meta property="article:published_time" content="2022-04-27T08:52:56+02:00"><meta property="article:modified_time" content="2022-04-27T08:52:56+02:00"><meta property="og:site_name" content="Guide OZ"><title>Séance 11 | Guide OZ</title><link rel=manifest href=/guide-oz/manifest.json><link rel=icon href=/guide-oz/favicon.png type=image/x-icon><link rel=stylesheet href=/guide-oz/book.min.87312a22c120b2e99e4dbec51f671dd6b1cb0bed3b12a909c39a0aa981eb5a8f.css integrity="sha256-hzEqIsEgsumeTb7FH2cd1rHLC+07EqkJw5oKqYHrWo8=" crossorigin=anonymous><script defer src=/guide-oz/flexsearch.min.js></script>
<script defer src=/guide-oz/en.search.min.19551305cc8c794db5a78149f7b38036fc3a838637d4a8e06196691681cd1e49.js integrity="sha256-GVUTBcyMeU21p4FJ97OANvw6g4Y31KjgYZZpFoHNHkk=" crossorigin=anonymous></script>
<link rel=stylesheet href=https://ahzed11.github.io/guide-oz/css/prism.css><script type=text/javascript src=https://ahzed11.github.io/guide-oz/js/prism.js></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/guide-oz/><span>Guide OZ</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://ahzed11.github.io/guide-oz/docs/installation/>Installation de Mozart2</a><ul><li><a href=https://ahzed11.github.io/guide-oz/docs/installation/vscode/>VSCode</a></li><li><a href=https://ahzed11.github.io/guide-oz/docs/installation/windows/>Windows</a></li><li><a href=https://ahzed11.github.io/guide-oz/docs/installation/macos/>Macos</a></li><li><a href=https://ahzed11.github.io/guide-oz/docs/installation/linux/>Linux</a></li></ul></li><li><a href=https://ahzed11.github.io/guide-oz/docs/tp/>TP</a><ul><li><a href=https://ahzed11.github.io/guide-oz/docs/tp/tp1/>Séance 1</a></li><li><a href=https://ahzed11.github.io/guide-oz/docs/tp/tp2/>Séance 2</a></li><li><a href=https://ahzed11.github.io/guide-oz/docs/tp/tp3/>Séance 3</a></li><li><a href=https://ahzed11.github.io/guide-oz/docs/tp/tp4/>Séance 4</a></li><li><a href=https://ahzed11.github.io/guide-oz/docs/tp/tp5/>Séance 5</a></li><li><a href=https://ahzed11.github.io/guide-oz/docs/tp/tp6/>Séance 6</a></li><li><a href=https://ahzed11.github.io/guide-oz/docs/tp/tp8/>Séance 8</a></li><li><a href=https://ahzed11.github.io/guide-oz/docs/tp/tp9/>Séance 9</a></li><li><a href=https://ahzed11.github.io/guide-oz/docs/tp/tp10/>Séance 10</a></li><li><a href=https://ahzed11.github.io/guide-oz/docs/tp/tp11/ class=active>Séance 11</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/guide-oz/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Séance 11</strong>
<label for=toc-control><img src=/guide-oz/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#exercice-1>Exercice 1</a></li><li><a href=#exercice-2>Exercice 2</a></li><li><a href=#exercice-3>Exercice 3</a><ul><li><a href=#impact>Impact</a></li><li><a href=#diagramme>Diagramme</a></li></ul></li><li><a href=#exercice-4>Exercice 4</a></li><li><a href=#excercice-5>Excercice 5</a></li></ul></nav></aside></header><article class=markdown><h1 id=séance-11>Séance 11
<a class=anchor href=#s%c3%a9ance-11>#</a></h1><h2 id=exercice-1>Exercice 1
<a class=anchor href=#exercice-1>#</a></h2><p>Je n&rsquo;arrive pas à ajouter des images pour le moment. #PasDeChance</p><h2 id=exercice-2>Exercice 2
<a class=anchor href=#exercice-2>#</a></h2><p>S&rsquo;il n&rsquo;y a qu&rsquo;un seul contrôleur, il n&rsquo;y aura qu&rsquo;un seul ascenseur en mouvement à la fois.</p><h2 id=exercice-3>Exercice 3
<a class=anchor href=#exercice-3>#</a></h2><h3 id=impact>Impact
<a class=anchor href=#impact>#</a></h3><p>Impacte la vitesse de traitement des requêtes par les acenseurs car ils &ldquo;bloquent&rdquo;. Rien d&rsquo;autre.</p><h3 id=diagramme>Diagramme
<a class=anchor href=#diagramme>#</a></h3><p>Pas besoin de contrôleur</p><h2 id=exercice-4>Exercice 4
<a class=anchor href=#exercice-4>#</a></h2><pre tabindex=0><code class=language-oz data-lang=oz>% Enlevez le controleur

proc {Lift Num Init Cid Floors ?Lid}
    fun {Controller Dest state(Pos Sched)}
        NewPos
    in
        if Pos &lt; Dest then
            {Delay 1000}
            NewPos = Pos + 1
        elseif Pos &gt; Dest then
            {Delay 1000}
            NewPos = Pos - 1
        end
        state(NewPos Sched)
    end
    fun {Scheduler state(Pos Sched)}
        {Browse &#39;Lift &#39;#Num#&#39; at floor &#39;#Pos}
        case Sched
        of S|Sched2 then
            if Pos == S then
                {Wait {Send Floors.S arrive($)}}
                if Sched2 == nil then
                    state(Pos nil)
                else
                    {Scheduler {Controller Sched2.1 state(Pos Sched2)}}
                end
            else
                {Scheduler {Controller S state(Pos Sched)}}
            end
        else
            State(Pos Sched)
        end
    end
in
    {NewPortObject Init fun {$ Msg state(Pos Sched)}
    case Msg
    of call(N) then
        {Browse &#39;Lift &#39;#Num#&#39; needed at floor &#39;#N}
        if N == Pos andthen {Not Moving} then
            {Wait {Send Floors.Pos arrive($)}}
            state(Pos Sched)
        else NewSched NewState in
            NewSched = {Append Sched [N]}
            {Scheduler state(Pos NewSched)}
        end
    end
    Lid}
end
</code></pre><h2 id=excercice-5>Excercice 5
<a class=anchor href=#excercice-5>#</a></h2><pre tabindex=0><code class=language-oz data-lang=oz>% Remettez le controleur
proc {Lift Num Init Cid Floors ?Lid}
    fun {Scheduler state(NewPos Scheduled Moving)}
        fun {ChooseBestDest Scheduled Best}
            case Scheduled
            of H|T then
                if {Abs NewPos-H} &lt; Best then
                    {ChooseBestDest T H}
                else
                    {ChooseBestDest T Best}
                end
            else
                Dest
            end
        end
    in
        case Scheduled
        of Dest|Tail then
            if Dest == NewPos then
                {Wait {Send Floors.Dest arrive($)}}
                if Tail == nil then
                    state(NewPos nil false)
                else
                    {Send Cid step(Lid NewPos Tail.1)}
                    state(NewPos Tail true)
                end
            else
                BestDest = {ChooseBestDest Scheduled Dest}
            in
                {Send Cid step(Lid NewPos BestDest)}
                state(NewPos Scheduled true)
            end
        else
            state(Pos Scheduled Moving)
        end
    end
in
    {NewPortObject Init fun {$ Msg state(Pos Sched Moving)}
    case Msg
    of call(N) then
        {Browse &#39;Lift &#39;#Num#&#39; needed at floor &#39;#N}
        if N == Pos andthen {Not Moving} then
            {Wait {Send Floors.Pos arrive($)}}
            state(Pos Sched false)
        else 
            Sched2
        in
            Sched2={Append Sched [N]}
            if {Not Moving} then
                {Send Cid step(Lid Pos Sched2.1)}
            end
            state(Pos Sched2 true)
        end
    [] &#39;at&#39;(NewPos) then
        {Browse &#39;Lift &#39;#Num#&#39; at floor &#39;#NewPos}
        case Sched
        of nil then
            state(NewPos Sched Moving)
        [] S|Sched2 then
            if NewPos == S then
                {Wait {Send Floors.S arrive($)}}
                if Sched2 == nill then
                    state(NewPos nil false)
                else
                    {Send Cid step(Lid NewPos Sched2.1)}
                    state(NewPos Sched2 true)
                end
            else
                {Send Cid step(Lid NewPos S)}
                state(NewPos Sched true)
            end
        end
    end
    end Lid}
end
</code></pre></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(n){const e=window.getSelection(),t=document.createRange();t.selectNodeContents(n),e.removeAllRanges(),e.addRange(t)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#exercice-1>Exercice 1</a></li><li><a href=#exercice-2>Exercice 2</a></li><li><a href=#exercice-3>Exercice 3</a><ul><li><a href=#impact>Impact</a></li><li><a href=#diagramme>Diagramme</a></li></ul></li><li><a href=#exercice-4>Exercice 4</a></li><li><a href=#excercice-5>Excercice 5</a></li></ul></nav></div></aside></main></body></html>